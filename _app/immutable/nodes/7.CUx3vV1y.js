import{s as H,a as x,f as L,t as be,d as se,c as $}from"../chunks/NT8NRc0h.js";import{p as V,c as s,s as v,r as a,t as T,a as B,n as W,g as e,o as Q,b as j,f as R,e as D,u as N,i as me,d as _e,$ as he}from"../chunks/DN6A0naj.js";import{i as I,p as le,s as ge,a as xe,c as ie}from"../chunks/kWoj3Qxl.js";import{e as S}from"../chunks/SrmGGwdX.js";import{h as pe,P as ye}from"../chunks/CGRCA45q.js";import{p as Y}from"../chunks/DqKiQXOL.js";import{o as qe,a as we}from"../chunks/DWi8nBnj.js";import{s as ne,I as ee,e as ke,f as He}from"../chunks/XaqINB52.js";import{b as ze}from"../chunks/CkpWWlpt.js";import{r as Ee}from"../chunks/BYfBAJde.js";import{q as Z}from"../chunks/GIsLircH.js";var Ae=L('<a class="flex items-center gap-1" target="_blank" rel="noopener noreferrer"><!> <span class="flex-auto truncate"> </span> <span class="flex-none text-sm opacity-70"> </span></a>');function Ce(A,o){V(o,!0);var t=Ae(),_=s(t);{var p=d=>{ee(d,{class:"h-5 w-5 flex-none rounded-full border border-base-200 text-success",icon:"carbon:checkmark-filled"})},m=d=>{ee(d,{class:"h-5 w-5 flex-none rounded-full border border-base-200 text-error",icon:"carbon:close-filled"})};I(_,d=>{o.history.question.choices.find(z=>z.answer)?.text===o.history.answer?d(p):d(m,!1)})}var b=v(_,2),c=s(b,!0);a(b);var u=v(b,2),i=s(u);a(u),a(t),T(d=>{ne(t,"href",d),H(c,o.history.question.question),H(i,`aus ${o.history.question.catalog??""}`)},[()=>Ee("/search")+`#question-${o.history.question.id}`]),x(A,t),B()}var Te=L('<div class="grid grid-cols-1 items-end rounded-md border-2 border-base-200 p-2 lg:grid-cols-3"><div><div class="text-center text-lg font-bold text-primary"> </div> <h3 class="text-center text-sm font-semibold opacity-70">beantwortete Fragen</h3></div> <div class="inline-flex flex-col gap-2"><div class="radial-progress self-center font-bold text-primary" role="progressbar"> </div> <h3 class="text-center text-sm font-semibold opacity-70">richtige Antworten</h3></div> <div><div class="text-center text-lg font-bold text-primary"> <!></div> <h3 class="text-center text-sm font-semibold opacity-70">meisten Fehler in Fragenkatalog</h3></div></div>');function Le(A,o){V(o,!0);let t=le(o,"history",19,()=>[]),_=Q(()=>t().reduce(u,0)),p=Q(()=>t().length>0?Math.round(e(_)/t().length*100):0),m=Q(()=>t().reduce(c,{})),b=Q(()=>Object.keys(e(m)).reduce((r,l)=>{let n=e(m)[l].incorrect/t().length;return n>r.ratio?{ratio:n,catalog:l}:r},{ratio:0,catalog:"-"}));function c(r,l){let n=l.question.catalog,k=l.question.choices.find(F=>F.answer);return n&&k&&(n in r||(r[n]={correct:0,incorrect:0}),k.text===l.answer?r[n].correct+=1:r[n].incorrect+=1),r}function u(r,l){let n=l.question.choices.find(k=>k.answer);return n&&n.text===l.answer?r+1:r}var i=Te(),d=s(i),z=s(d),M=s(z,!0);a(z),W(2),a(d);var h=v(d,2),f=s(h),g=s(f,!0);a(f),W(2),a(h);var y=v(h,2),E=s(y),q=s(E),P=v(q);{var w=r=>{var l=be();T(()=>H(l,`(${e(m)[e(b).catalog].incorrect})`)),x(r,l)};I(P,r=>{e(b).catalog!=="-"&&r(w)})}a(E),W(2),a(y),a(i),T(()=>{H(M,t().length),ke(f,`--value:${e(p)};`),H(g,`${e(p)}%`),H(q,`${e(b).catalog??""} `)}),x(A,i),B()}var Me=L('<h2 class="sticky top-0 z-10 bg-base-200 text-lg font-semibold"> </h2> <div class="flex flex-col gap-2"></div>',1),Pe=L('<div class="mt-4 flex flex-col gap-2"><!> <div class="self-end"><div class="join"><label class="select join-item"><span class="label">ältesten</span> <select><option>1</option><option>3</option><option>10</option><option>50</option><option>Alle</option></select></label> <button class="btn join-item btn-square btn-error" type="button"><!></button></div></div> <div class="flex h-120 flex-col gap-4 overflow-y-scroll"></div></div>');function Qe(A,o){V(o,!0);const t=()=>xe(Z,"$quizHistory",_),[_,p]=ge();let m=D(20),b=D(10),c=le(o,"selected",3,!1),u=Q(()=>z(t()[o.tab.id])),i=D(null);qe(()=>{e(i)&&e(i).addEventListener("scroll",()=>{e(i)&&e(i).scrollTop+e(i).clientHeight>=e(i).scrollHeight&&j(m,e(m)+10)})}),we(()=>{e(i)&&e(i).removeEventListener("scroll",()=>{})});function d(){e(b)===-1?ie(Z,N(t)[o.tab.id]=[],N(t)):ie(Z,N(t)[o.tab.id]=t()[o.tab.id].slice(0,t()[o.tab.id].length-e(b)),N(t))}function z(g){if(!g)return;let y=new Date,E=[{label:"Jetzt",time:1,history:[]},{label:"Letzten Minuten",time:10,history:[]},{label:"Letzter Stunde",time:60,history:[]},{label:"Letzten Tag",time:1440,history:[]},{label:"Älter",time:Number.MAX_SAFE_INTEGER,history:[]}];for(let q of g.slice(0,e(m))){let P=(y.getTime()-q.date.getTime())/1e5,w=E.find(r=>r.time>P);w&&(w.history=[...w.history,q])}return E}var M=$(),h=R(M);{var f=g=>{var y=Pe(),E=s(y);Le(E,{get history(){return t()[o.tab.id]}});var q=v(E,2),P=s(q),w=s(P),r=v(s(w),2),l=s(r);l.value=l.__value=1;var n=v(l);n.value=n.__value=3;var k=v(n);k.value=k.__value=10;var F=v(k);F.value=F.__value=50;var te=v(F);te.value=te.__value=-1,a(r),a(w);var G=v(w,2);G.__click=d;var ce=s(G);ee(ce,{icon:"mi:delete"}),a(G),a(P),a(q);var J=v(q,2);S(J,21,()=>e(u),C=>C.label,(C,O)=>{var re=$(),de=R(re);{var ve=U=>{var ae=Me(),X=R(ae),ue=s(X,!0);a(X);var oe=v(X,2);S(oe,21,()=>e(O).history,K=>K.date,(K,fe)=>{Ce(K,{get history(){return e(fe)}})}),a(oe),T(()=>H(ue,e(O).label)),x(U,ae)};I(de,U=>{e(O).history.length>0&&U(ve)})}x(C,re)}),a(J),ze(J,C=>j(i,C),()=>e(i)),a(y),T(()=>ne(y,"id",o.tab.id)),He(r,()=>e(b),C=>j(b,C)),x(g,y)};I(h,g=>{c()&&g(f)})}x(A,M),B(),p()}se(["click"]);var je=L('<button role="tab" type="button" class="tab-active tab flex-auto select-auto"> </button>'),Fe=L('<button role="tab" type="button" class="tab flex-auto select-auto"> </button>'),Ie=L('<div><h1 class="mb-2 text-center text-3xl font-semibold">Verlauf</h1> <div role="tablist" class="tabs-box tabs w-full tabs-xl"></div> <!></div>');function Ke(A,o){V(o,!0);const t=[{id:"endless",name:"Endlosquiz"},{id:"quiz",name:"Quiz"}];let _=D(me(t[0].id));Y.url.hash&&t.some(c=>"#"+c.id===Y.url.hash)&&j(_,Y.url.hash.replace("#",""),!0);var p=Ie();pe("1xl2tfr",c=>{_e(()=>{he.title=`Verlauf - ${ye}`})});var m=v(s(p),2);S(m,21,()=>t,c=>c.id,(c,u)=>{var i=$(),d=R(i);{var z=h=>{var f=je();f.__click=()=>j(_,e(u).id,!0);var g=s(f,!0);a(f),T(()=>H(g,e(u).name)),x(h,f)},M=h=>{var f=Fe();f.__click=()=>j(_,e(u).id,!0);var g=s(f,!0);a(f),T(()=>H(g,e(u).name)),x(h,f)};I(d,h=>{e(_)==e(u).id?h(z):h(M,!1)})}x(c,i)}),a(m);var b=v(m,2);S(b,17,()=>t,c=>c.id,(c,u)=>{{let i=Q(()=>e(_)===e(u).id);Qe(c,{get tab(){return e(u)},get selected(){return e(i)}})}}),a(p),x(A,p),B()}se(["click"]);export{Ke as component};
