import{l as ue,a as H,t as S,b as ce,s as F,h as fe,c as _e,e as pe}from"../chunks/disclose-version.BWTWBhB4.js";import{i as Z,P as me}from"../chunks/public.Dj7Vthdi.js";import{e as le,p as ee,a0 as B,a1 as ge,t as k,a as te,g as e,m as L,c,r as n,n as G,s as u,b as A,a5 as D,$ as be,a3 as he,f as xe,a2 as ae}from"../chunks/runtime.BtXH3TXM.js";import{a as ye,p as ne,i as O}from"../chunks/props.CqWHPKN1.js";import{e as K,i as W}from"../chunks/each.DRxh5sp6.js";import{s as J,I as re,r as qe}from"../chunks/Icon.BPb3u_LU.js";import{c as ze}from"../chunks/input.cFgeiN8w.js";import{s as we,a as oe,b as ie}from"../chunks/store.5iZEm9oW.js";import{q as Y}from"../chunks/stores.TwdxsUJJ.js";import{b as $e}from"../chunks/paths.C1uUrTZP.js";import{p as He}from"../chunks/stores.tzJVBV5S.js";function ve(r,f,i){if(r.multiple)return Ae(r,f);for(var v of r.options){var t=R(v);if(ye(t,f)){v.selected=!0;return}}(!i||f!==void 0)&&(r.selectedIndex=-1)}function ke(r,f){le(()=>{var i=new MutationObserver(()=>{var v=r.__value;ve(r,v)});return i.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function se(r,f,i=f){var v=!0;ue(r,"change",t=>{var p=t?"[selected]":":checked",s;if(r.multiple)s=[].map.call(r.querySelectorAll(p),R);else{var x=r.querySelector(p)??r.querySelector("option:not([disabled])");s=x&&R(x)}i(s)}),le(()=>{var t=f();if(ve(r,t,v),v&&t===void 0){var p=r.querySelector(":checked");p!==null&&(t=R(p),i(t))}r.__value=t,v=!1}),ke(r)}function Ae(r,f){for(var i of r.options)i.selected=~f.indexOf(R(i))}function R(r){return"__value"in r?r.__value:r.value}var Ce=S('<div class="border-2 border-base-200 p-2 rounded-md mb-4 grid grid-cols-1 lg:grid-cols-3 items-end"><div><div class="text-lg font-bold text-center"> </div> <h3 class="text-sm font-semibold text-center opacity-70">beantwortete Fragen</h3></div> <div class="inline-flex flex-col gap-2"><div class="radial-progress self-center text-primary font-bold" role="progressbar"> </div> <h3 class="text-sm font-semibold text-center opacity-70">richtige Antworten</h3></div> <div><div class="text-lg font-bold text-center"> <!></div> <h3 class="text-sm font-semibold text-center opacity-70">meisten Fehler in Fragenkatalog</h3></div></div>');function Le(r,f){ee(f,!1);const i=L(),v=L(),t=L(),p=L();let s=ne(f,"quizHistory",8);function x(d,g){let a=g.question.catalog,o=g.question.choices.find(l=>l.answer);return a&&o&&(a in d||(d[a]={correct:0,incorrect:0}),o.text===g.answer?d[a].correct+=1:d[a].incorrect+=1),d}function z(d,g){let a=g.question.choices.find(o=>o.answer);return a&&a.text===g.answer?d+1:d}B(()=>D(s()),()=>{A(i,s().reduce(z,0))}),B(()=>(D(s()),e(i)),()=>{A(v,s().length>0?Math.round(e(i)/s().length*100):0)}),B(()=>D(s()),()=>{A(p,s().reduce(x,{}))}),B(()=>(e(p),D(s())),()=>{A(t,Object.keys(e(p)).reduce((d,g)=>{let a=e(p)[g].incorrect/s().length;return a>d.ratio?{ratio:a,catalog:g}:d},{ratio:0,catalog:"-"}))}),ge(),Z();var m=Ce(),C=c(m),q=c(C),E=c(q,!0);n(q),G(2),n(C);var w=u(C,2),I=c(w),P=c(I,!0);n(I),G(2),n(w);var Q=u(w,2),T=c(Q),j=c(T),U=u(j);{var N=d=>{var g=ce();k(()=>F(g,`(${e(p)[e(t).catalog].incorrect})`)),H(d,g)};O(U,d=>{e(t).catalog!=="-"&&d(N)})}n(T),G(2),n(Q),n(m),k(()=>{F(E,s().length),J(I,"style",`--value:${e(v)};`),F(P,`${e(v)}%`),F(j,`${e(t).catalog??""} `)}),H(r,m),te()}var Fe=S('<a class="flex items-center gap-1" target="_blank"><!> <div class="flex-1"> <span class="text-sm opacity-70"> </span></div></a>');function Se(r,f){ee(f,!1);let i=ne(f,"history",8);Z();var v=Fe(),t=c(v);{var p=q=>{re(q,{class:"w-5 h-5 rounded-full border border-base-200 text-success",icon:"carbon:checkmark-filled"})},s=q=>{re(q,{class:"w-5 h-5 rounded-full border border-base-200 text-error",icon:"carbon:close-filled"})};O(t,q=>{var E;((E=i().question.choices.find(w=>w.answer))==null?void 0:E.text)===i().answer?q(p):q(s,!1)})}var x=u(t,2),z=c(x),m=u(z),C=c(m);n(m),n(x),n(v),k(()=>{J(v,"href",$e+`/search#${i().question.id}`),F(z,`${i().question.question??""} `),F(C,`aus ${i().question.catalog??""}`)}),H(r,v),te()}var Ee=S('<input type="radio" class="tab flex-auto font-bold select-auto" role="tab" name="tabs">'),Ie=S('<div class="flex flex-row items-center gap-2"><span class="font-bold">Letzten</span> <select class="select select-bordered select-sm"><option>10</option><option>20</option><option>50</option><option>Alle</option></select> <span class="font-bold">Fragen</span></div>'),Me=S('<div><span class="font-bold text-primary text-sm"> </span> <div class="flex flex-col gap-0.5"></div></div>'),Pe=S('<div class="flex items-center gap-2"><span class="font-bold">ältesten</span> <div class="join"><select class="join-item select select-error select-sm"><option>10</option><option>20</option><option>50</option><option>Alle</option></select> <button class="join-item btn btn-error btn-sm">Löschen</button></div></div>'),Qe=S('<div><h1 class="text-3xl text-center font-semibold mb-2">Verlauf</h1> <div class="flex flex-col gap-4"><div class="tabs tabs-bordered flex" role="tablist"></div> <!> <!> <div class="flex flex-col gap-1"></div> <!></div></div>');function Xe(r,f){ee(f,!1);const i=we(),v=()=>oe(He,"$page",i),t=()=>oe(Y,"$quizHistory",i),p=[];let s=L(10),x=L(10);const z=[{id:"all",name:"Alle"},{id:"endless",name:"Endlosquiz"},{id:"quiz",name:"Quiz"}];let m=L(z[0].id);v().url.hash&&z.some(a=>"#"+a.id===v().url.hash)&&A(m,v().url.hash.replace("#",""));let C=L(q(e(m),e(s)));function q(a,o){let l=[{label:"Jetzt",time:1,history:[]},{label:"Letzten Minuten",time:10,history:[]},{label:"Letzter Stunde",time:60,history:[]},{label:"Letzten Tag",time:1440,history:[]},{label:"Älter",time:Number.MAX_SAFE_INTEGER,history:[]}],_=0;for(let b of t()){if(b.type!==a&&a!==z[0].id)continue;let y=(Date.now()-b.date)/6e4;for(let h of l)if(y<h.time){h.history=[...h.history,b];break}if(_++,_>=o)break}return l}function E(){t().length<=e(x)?ie(Y,[]):ie(Y,t().slice(0,t().length-e(x))),A(C,q(e(m),e(s)))}Z();var w=Qe();fe(a=>{be.title=`Verlauf - ${me??""}`});var I=u(c(w),2),P=c(I);K(P,5,()=>z,W,(a,o)=>{var l=Ee();qe(l);var _;k(()=>{J(l,"id",e(o).id),J(l,"aria-label",e(o).name),_!==(_=e(o).id)&&(l.value=(l.__value=e(o).id)==null?"":e(o).id)}),ze(p,[],l,()=>(e(o).id,e(m)),b=>A(m,b)),H(a,l)}),n(P);var Q=u(P,2),T=he(()=>t().filter(a=>a.type===e(m)||e(m)===z[0].id));Le(Q,{get quizHistory(){return e(T)}});var j=u(Q,2);{var U=a=>{var o=Ie(),l=u(c(o),2);k(()=>{e(s),ae(()=>{t()})});var _=c(l);_.value=(_.__value=10)==null?"":10;var b=u(_);b.value=(b.__value=20)==null?"":20;var y=u(b);y.value=(y.__value=50)==null?"":50;var h=u(y),$={};n(l),G(2),n(o),k(()=>{$!==($=t().length)&&(h.value=(h.__value=t().length)==null?"":t().length)}),se(l,()=>e(s),M=>A(s,M)),H(a,o)};O(j,a=>{t().length>0&&a(U)})}var N=u(j,2);K(N,5,()=>e(C),W,(a,o)=>{var l=_e(),_=xe(l);{var b=y=>{var h=Me(),$=c(h),M=c($,!0);n($);var V=u($,2);K(V,5,()=>e(o).history,W,(X,de)=>{Se(X,{get history(){return e(de)}})}),n(V),n(h),k(()=>F(M,e(o).label)),H(y,h)};O(_,y=>{e(o).history.length>0&&y(b)})}H(a,l)}),n(N);var d=u(N,2);{var g=a=>{var o=Pe(),l=u(c(o),2),_=c(l);k(()=>{e(x),ae(()=>{t()})});var b=c(_);b.value=(b.__value=10)==null?"":10;var y=u(b);y.value=(y.__value=20)==null?"":20;var h=u(y);h.value=(h.__value=50)==null?"":50;var $=u(h),M={};n(_);var V=u(_,2);n(l),n(o),k(()=>{M!==(M=t().length)&&($.value=($.__value=t().length)==null?"":t().length)}),se(_,()=>e(x),X=>A(x,X)),pe("click",V,E),H(a,o)};O(d,a=>{t().length>0&&e(m)===z[0].id&&a(g)})}n(I),n(w),H(r,w),te()}export{Xe as component};
